<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>From Snowflake Servers to GitOps Nirvana</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A beginner-friendly tour of the declarative stack that actually runs itself.">
  <meta name="keywords" content="GitOps,NixOS,Kubernetes,ArgoCD,Terraform,Docker,DSPy,OPA">
  <meta name="author" content="Jonathan McGuinness">
  <meta name="theme-color" content="#111827">

  <style>
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif;
      line-height:1.6;
      margin:2rem auto;
      max-width:680px;
      padding:0 1rem;
      color:#ffffff;
      background:#111827;
    }
    h1,h2{color:#60a5fa;}
    table{width:100%;border-collapse:collapse;margin:1rem 0;}
    th,td{padding:.5rem;border:1px solid #374151;text-align:left;}
    code{background:#1f2937;padding:.15rem .35rem;border-radius:3px;}
    pre{background:#1f2937;padding:1rem;overflow-x:auto;}
    a{color:#00ff00;}a:visited{color:#22c55e;}
    img{max-width:100%;height:auto;border-radius:6px;}
    /* copy buttons */
    .copy-btn{
      color:#fff; /* white text */
      background:transparent;
      border:none;
      cursor:pointer;
      font-size:1rem;
      margin-left:.15rem;
      transition:transform .1s;
    }
    .copy-btn:hover{
      transform:scale(1.15);
    }
    .copy-icon{
      color:#fff; /* white rectangles on dark bg */
      vertical-align:middle;
    }
    @media (min-width: 1024px) {
      .toc { position: sticky; top: 2rem; }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  
</head>

<body>
  <h1>From Snowflake Servers to GitOps Nirvana</h1>
  <p class="tagline">
  <em>8 open-source tools you can combine so that <strong>git push</strong> deploys your entire stack.</em>
  </p>
  
  <!-- paragraph with per-link copy buttons -->
<p>
  You‚Äôve probably heard the buzzwords: GitOps, NoOps, immutable infrastructure.<br>
  Today I‚Äôd like to walk you‚Äîstep by step‚Äîthrough why these concepts exist and how a small constellation of tools
  (<a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a>,
   <a href="https://nixos.org/" target="_blank" rel="noopener">NixOS</a>,
   <a href="https://docker.com/" target="_blank" rel="noopener">Docker</a>,
   <a href="https://developer.hashicorp.com/terraform/" target="_blank" rel="noopener">Terraform</a>,
   <a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a>,
   <a href="https://argo-cd.readthedocs.io/en/stable/" target="_blank" rel="noopener">ArgoCD</a>,
   <a href="https://dspy.ai/" target="_blank" rel="noopener">DSPy</a>,
   and <a href="https://www.openpolicyagent.org/" target="_blank" rel="noopener">OPA</a>)
  fit together to create a platform that deploys itself every time you hit <i>merge</i>.
  <button id="copyAllTools" class="copy-btn" title="Copy all tool URLs">
  <svg class="copy-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
    <rect x="3" y="3" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.4"/>
    <rect x="1" y="1" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.4"/>
  </svg>
  All
</button>
</p>
  <details class="toc">
  <summary>Quick tool map (click to open)</summary>
  <table border="1" cellpadding="6" cellspacing="0">
  <tr>
    <td><a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a></td>
    <td><a href="https://nixos.org/" target="_blank" rel="noopener">NixOS</a></td>
    <td><a href="https://docker.com/" target="_blank" rel="noopener">Docker</a></td>
    <td><a href="https://developer.hashicorp.com/terraform/" target="_blank" rel="noopener">Terraform</a></td>
    <td><a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a></td>
    <td><a href="https://argo-cd.readthedocs.io/en/stable/" target="_blank" rel="noopener">ArgoCD</a></td>
    <td><a href="https://dspy.ai/" target="_blank" rel="noopener">DSPy</a></td>
    <td><a href="https://www.openpolicyagent.org/" target="_blank" rel="noopener">OPA</a></td>
  </tr>
</table>

</details>

  <!-- rest of your article -->
  <h2>1. The Problem We‚Äôre Solving</h2>
  <p>In the old world, a server was a pet: lovingly hand-fed config files, patched on Sundays, and inevitably different from every other server. The result?</p>
  <ul>
    <li>‚ÄúIt works on my machine!‚Äù</li>
    <li>Snow-flake drift and 3 a.m. pages.</li>
    <li>Scaling = more pets.</li>
  </ul>

  <h2>2. The North Star: Everything as Code</h2>
  <p>Instead of pets, we want cattle - identical, replaceable, and defined in text files that live in Git.<br>
  If Git is the single source of truth, the rest of the stack becomes a conveyor belt that turns that truth into running software.</p>

  <h2>3. The Cast of Characters and Their Jobs</h2>
  <table border="1" cellpadding="8" style="border-collapse:collapse;">
    <thead><tr><th>Tool</th><th>One-Sentence Job</th><th>Why It Matters</th></tr></thead>
    <tbody>
      <tr><td><strong>Git</strong></td><td>The single source-of-truth for every line of code and config.</td><td>Immutable history + pull-requests = collaboration without chaos.</td></tr>
      <tr><td><strong>NixOS</strong></td><td>An entire Linux distro expressed in one declarative file.</td><td>Reinstalls laptop or 1 000-server fleet with <code>nixos-rebuild</code>.</td></tr>
      <tr><td><strong>Terraform</strong></td><td>Describe cloud resources (VPCs, disks, IAM) in HCL.</td><td>Re-creates an entire region from scratch in 15 min after a coffee spill.</td></tr>
      <tr><td><strong>Docker</strong></td><td>Bundle the app and its libraries into an immutable image.</td><td>Same artifact runs on your Mac, in CI, and in prod.</td></tr>
      <tr><td><strong>Argo CD</strong></td><td>A robot that watches Git and makes Kubernetes match it.</td><td>Manual <code>kubectl apply</code> is now a pull-request review.</td></tr>
      <tr><td><strong>Kubernetes</strong></td><td>The planet-scale scheduler that keeps those containers healthy.</td><td>Auto-heals, scales, and rolls out with zero downtime.</td></tr>
      <tr><td><strong>DSPy</strong></td><td>Prompt-engineering as typed, testable code.</td><td>Turns LLM prompts into reproducible pipelines.</td></tr>
      <tr><td><strong>OPA / Kyverno</strong></td><td>Policy-as-code gatekeepers for every API call.</td><td>Blocks <code>:latest</code> images or unencrypted buckets before they deploy.</td></tr>
    </tbody>
  </table>

  <h2>4. How the Characters relate to Each Other</h2>
  <p>  <!-- external SVG as image -->
  <img src="/images/DeclarativeArchitectureMermaidChart-Dark.svg" alt="Declarative GitOps workflow" style="width:100%;height:auto;border-radius:6px;border:1px solid #374151;">
    <p style="margin-top:.25rem;font-size:.8em;color:#9ca3af;">
  üí° Press <kbd>Ctrl</kbd> + <kbd>+</kbd> / <kbd>-</kbd>, or pinch-zoom on mobile to enlarge the diagram.
</p>
    
  <h2>5. A Day in the Life of a Change</h2>
  <p>Let‚Äôs add a new feature: ‚ÄúShow real-time in-game leaderboards‚Äù.</p>
  <ol>
    <li><strong>Code</strong>
      <ul>
        <li>Write the leaderboard service in Go.</li>
        <li>Add a DSPy pipeline to pre-aggregate stats.</li>
        <li>Commit everything to git.</li>
      </ul>
    </li>
    <li><strong>CI Gate</strong>
      <ul>
        <li>Nix builds the Docker image (bit-for-bit reproducible).</li>
        <li>Terraform dry-run shows a new Redis cache.</li>
        <li>Tests pass ‚Üí image is signed & pushed.</li>
      </ul>
    </li>
    <li><strong>GitOps Sync</strong>
      <ul>
        <li>Argo CD detects the new commit hash.</li>
        <li>Kubernetes manifests are applied; pods roll out blue-green.</li>
        <li>OPA policy ensures the service can‚Äôt talk to the payments DB.</li>
      </ul>
    </li>
    <li><strong>Observe</strong>
      <ul>
        <li>Prometheus sees p95 latency drop.</li>
        <li>Grafana dashboard auto-updates.</li>
        <li>No humans touched a server.</li>
      </ul>
    </li>
  </ol>

  <h2>6. Beginner Take-aways</h2>
  <ul>
    <li>Start small: Put one service in Docker, store its manifest in Git, and let Argo CD sync it.</li>
    <li>Lean on NixOS for dev laptops - <code>nix develop</code> gives the exact same tools as prod.</li>
    <li>Policies early: A 15-line OPA rule today prevents a 3 a.m. breach tomorrow.</li>
    <li>Celebrate merges: Every green PR is a fully tested, policy-compliant, zero-downtime release.</li>
  </ul>

  <!-- assets list + copy button -->
<!-- ===== Grab the configs ===== -->
<section id="stack-assets">
  <h3>üì¶ Grab the configs</h3>
  <button onclick="copyAssets()" class="copy-btn">
    <svg class="copy-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <rect x="3" y="3" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.4"/>
      <rect x="1" y="1" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.4"/>
    </svg>
    Copy URLs
  </button>

  <ol>
    <li><a href="assets/README.md" download>README.md</a></li>
    <li><a href="assets/flake.nix" download><details>
  <summary>flake.nix (click to expand)</summary>
  <pre><code class="language-nix">{
  description = "Reproducible Dev Shell";

  inputs.nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
  inputs.flake-utils.url = "github:numtide/flake-utils";

  outputs = { self, nixpkgs, flake-utils }:
    flake-utils.lib.eachDefaultSystem (system:
      let pkgs = nixpkgs.legacyPackages.${system};
      in {
        devShells.default = pkgs.mkShell {
          packages = with pkgs; [
            terraform
            kubectl
            argocd
            docker
          ];
        };
      });
}</code></pre>
</details></a></li>
    
    <li><a href="assets/main.tf" download>main.tf</a></li>
    <li><a href="assets/argocd-app.yaml" download>argocd-app.yaml</a></li>
    <li><a href="assets/constraint-template.yaml" download>constraint-template.yaml</a></li>
  </ol>
</section>

  <h2>7. The Bigger Picture</h2>
  <p>Declarative, Git-driven stacks aren‚Äôt tools; they‚Äôre a culture.<br>
     When everything is code, knowledge lives in the repo, not in someone‚Äôs head.<br>
     That means faster onboarding, fearless refactors, and - best of all - Friday deploys that don‚Äôt ruin weekends.</p>
  <p><strong>Welcome to the Declared World: where the robots do the toil, and we get back to building great games.</strong></p>

  <!-- JavaScript for copy buttons -->
  <script>
  function copyUrl(url) {
    navigator.clipboard.writeText(url).then(() => {
      const btn = event.target;
      btn.textContent = '‚úÖ';
      setTimeout(() => btn.textContent = 'CC', 800);
    });
  }
  function copyAssets() {
    const urls = Array.from(document.querySelectorAll('#stack-assets a')).map(a => a.href).join('\n');
    navigator.clipboard.writeText(urls).then(() => {
      const btn = event.target;
      btn.textContent = '‚úÖ Copied!';
      setTimeout(() => btn.textContent = 'CC Copy URLs', 1200);
    });
  }
  document.getElementById('copyAllTools').addEventListener('click', () => {
    const urls = [
  'https://git-scm.com/',
  'https://nixos.org/',
  'https://docker.com/',
  'https://developer.hashicorp.com/terraform/',
  'https://kubernetes.io/',
  'https://argo-cd.readthedocs.io/en/stable/',
  'https://dspy.ai/',
  'https://www.openpolicyagent.org/'
].join('\n');
    navigator.clipboard.writeText(urls).then(() => {
      const btn = document.getElementById('copyAllTools');
      btn.textContent = '‚úÖ Copied!';
      setTimeout(() => btn.textContent = 'CC All', 1200);
    });
  });
  </script>
</body>
</html>
