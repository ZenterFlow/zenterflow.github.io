<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>From Snowflake Servers to GitOps Nirvana</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A beginner-friendly tour of the declarative stack that actually runs itself.">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      line-height: 1.6;
      margin: 2rem auto;
      max-width: 680px;
      padding: 0 1rem;
      color: #ffffff;          /* white text */
      background: #111827;     /* dark background for contrast */
    }
    h1, h2 { color: #60a5fa; } /* light-blue headings */
    table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
    th, td { padding: .5rem; border: 1px solid #374151; text-align: left; }
    code { background: #1f2937; padding: .15rem .35rem; border-radius: 3px; }
    pre { background: #1f2937; padding: 1rem; overflow-x: auto; }
    img { max-width: 100%; height: auto; border-radius: 6px; }
    a { color: #00ff00; /* bright green */ }
    a:visited { color: #22c55e; /* keep same color after visiting */ }
  </style>
</head>

<body>
  <h1>From Snowflake Servers to GitOps Nirvana</h1>
  <p><em>A beginner-friendly tour of the declarative stack that actually runs itself — 04 Aug 2025</em></p>

  <p>You’ve probably heard the buzzwords: GitOps, NoOps, immutable infrastructure. Today I’d like to walk you - step by step - through why these concepts exist and how a small constellation of tools (<a _blank href="https://git-scm.com/">Git</a>, <a _blank href="https://nixos.org/">NixOS</a>, <a _blank href="https://docker.com/">Docker</a>, <a _blank href="https://developer.hashicorp.com/terraform/">Terraform</a>, <a _blank href="https://kubernetes.io/">Kubernetes</a>, <a _blank href="https://argo-cd.readthedocs.io/en/stable/">ArgoCD</a>, <a _blank href="https://dspy.ai/">DSPy</a>, and a pinch of <a _blank href="https://www.openpolicyagent.org/">OPA</a> policy-as-code) fit together to create a platform that deploys itself every time you hit <i>merge</i>.</p>
      <hr>
  <h2>1. The Problem We’re Solving</h2>
  <p>In the old world, a server was a pet: lovingly hand-fed config files, patched on Sundays, and inevitably different from every other server. The result?</p>
  <ul>
    <li>“It works on my machine!”</li>
    <li>Snow-flake drift and 3 a.m. pages.</li>
    <li>Scaling = more pets.</li>
  </ul>
      <hr>
  <h2>2. The North Star: Everything as Code</h2>
  <p>Instead of pets, we want cattle - identical, replaceable, and defined in text files that live in Git.</p>
  <p>If Git is the <i>single source of truth</i>, the rest of the stack becomes a conveyor belt that turns that truth into running software.</p>
      <hr>
  <h2>3. The Cast of Characters and Their Jobs</h2>
<section>
  <h2>Reproducible Stack Cheat-Sheet</h2>
  <table border="1" cellpadding="8" style="border-collapse:collapse;">
    <thead>
      <tr>
        <th>Tool</th>
        <th>One-Sentence Job</th>
        <th>Why It Matters</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Git</strong></td>
        <td>The single source-of-truth for every line of code and config.</td>
        <td>Immutable history + pull-requests = collaboration without chaos.</td>
      </tr>
      <tr>
        <td><strong>NixOS</strong></td>
        <td>An entire Linux distro expressed in one declarative file.</td>
        <td>Reinstalls laptop or 1 000-server fleet with <code>nixos-rebuild</code>.</td>
      </tr>
      <tr>
        <td><strong>Terraform</strong></td>
        <td>Describe cloud resources (VPCs, disks, IAM) in HCL.</td>
        <td>Re-creates an entire region from scratch in 15 min after a coffee spill.</td>
      </tr>
      <tr>
        <td><strong>Docker</strong></td>
        <td>Bundle the app and its libraries into an immutable image.</td>
        <td>Same artifact runs on your Mac, in CI, and in prod.</td>
      </tr>
      <tr>
        <td><strong>Argo CD</strong></td>
        <td>A robot that watches Git and makes Kubernetes match it.</td>
        <td>Manual <code>kubectl apply</code> is now a pull-request review.</td>
      </tr>
      <tr>
        <td><strong>Kubernetes</strong></td>
        <td>The planet-scale scheduler that keeps those containers healthy.</td>
        <td>Auto-heals, scales, and rolls out with zero downtime.</td>
      </tr>
      <tr>
        <td><strong>DSPy</strong></td>
        <td>Prompt-engineering as typed, testable code.</td>
        <td>Turns LLM prompts into reproducible pipelines.</td>
      </tr>
      <tr>
        <td><strong>OPA / Kyverno</strong></td>
        <td>Policy-as-code gatekeepers for every API call.</td>
        <td>Blocks <code>:latest</code> images or unencrypted buckets before they deploy.</td>
      </tr>
    </tbody>
  </table>
</section>

  <p>Table: A Declarative Software Stack</p>
  <!-- IMAGE 1 -->
  <figure>
    <img src="images/DeclarativeStack.jpg" alt="Diagram of declarative stack pipeline">
    <figcaption style="text-align:center;font-size:0.8rem;color:#9ca3af;">Table: A Declarative Software Stack</figcaption>
  </figure>
      <hr>
  <h2>4. How the Characters relate to Each Other</h2>
  <p>Table: A Declarative Software Architecture Workflow</p>
  <!-- IMAGE 2 -->
  <figure>
    <img src="images/DeclarativeArchitectureMermaidChart.png" alt="Screenshot of Argo CD dashboard">
    <figcaption style="text-align:center;font-size:0.8rem;color:#9ca3af;">Mermaid Diagram: A Declarative Software Architecture Workflow</figcaption>
  </figure>
      <hr>
  <h2>5. A Day in the Life of a Change</h2>
  <p>Let’s add a new feature: “Show real-time in-game leaderboards”.</p>
  <ol>
    <li><strong>Code</strong></li>
      <ul>
        <li>Write the leaderboard service in Go.</li>
        <li>Add a DSPy pipeline to pre-aggregate stats.</li>
        <li>Commit everything to git.</li>
      </ul>
    <li><strong>CI Gate</strong></li>
      <ul>
        <li>Nix builds the Docker image (bit-for-bit reproducible).</li>
        <li>Terraform dry-run shows a new Redis cache.</li>
        <li>Tests pass → image is signed & pushed.</li>
      </ul>
    <li><strong>GitOps Sync</strong></li>
      <ul>
        <li>Argo CD detects the new commit hash.</li>
        <li>Kubernetes manifests are applied; pods roll out blue-green.</li>
        <li>OPA policy ensures the service can’t talk to the payments DB.</li>
      </ul>
    <li><strong>Observe</strong></li>
      <ul>
        <li>Prometheus sees p95 latency drop.</li>
        <li>Grafana dashboard auto-updates.</li>
        <li>No humans touched a server.</li>
      </ul>
  </ol>
      <hr>
  <h2>6. Beginner Take-aways</h2>
  <ul>
    <li><strong>Start small:</strong> Put one service in Docker, store its manifest in Git, and let Argo CD sync it.</li>
    <li><strong>Lean on NixOS for dev laptops</strong> - nix develop gives the exact same tools as prod.</li>
    <li><strong>Policies early:</strong> A 15-line OPA rule today prevents a 3 a.m. breach tomorrow.</li>
    <li><strong>Celebrate merges:</strong> Every green PR is a fully tested, policy-compliant, zero-downtime release.</li>
  </ul>
      <br><br>
  <!-- ===== Reproducible Stack Assets ===== -->
<section id="stack-assets">
  <h3>Grab the configs</h3>
  <p>Everything below is ready to copy-paste from <code>assets/</code>.</p>

  <ol>
    <li>
      <a href="assets/README.md" download>
        README.md
      </a> — full walk-through & quick-start guide.
    </li>
    <li>
      <a href="assets/flake.nix" download>
        flake.nix
      </a> — NixOS dev-shell with pinned Terraform, kubectl, Argo CD CLI, Docker.
    </li>
    <li>
      <a href="assets/main.tf" download>
        main.tf
      </a> — Terraform plan to spin up an EKS cluster (swap provider blocks for GCP/Azure).
    </li>
    <li>
      <a href="assets/argocd-app.yaml" download>
        argocd-app.yaml
      </a> — Argo CD Application that bootstraps Gatekeeper in <code>gatekeeper-system</code>.
    </li>
    <li>
      <a href="assets/constraint-template.yaml" download>
        constraint-template.yaml
      </a> — OPA Gatekeeper template that rejects any container image tagged <code>:latest</code>.
    </li>
  </ol>
</section>
<!-- ===== /Assets ===== -->
  <hr>
  <h2>7. The Bigger Picture</h2>
  <p>Declarative, Git-driven stacks aren’t tools; they’re a culture.<br>
    When everything is code, knowledge lives in the repo, not in someone’s head.<br>
    That means faster onboarding, fearless refactors, and - best of all - Friday deploys that don’t ruin weekends.</p>
  <p><strong>Welcome to the Declared World:</strong> where the robots do the toil, and we get back to building great games.</p>
    <hr>
  <p style="font-size:0.9em;color:#9ca3af;">
    © 2025 Jonathan McGuinness · 
  </p>
</body>
</html>
